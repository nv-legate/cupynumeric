

<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Extend cuPyNumeric with Legate-tasks &#8212; NVIDIA cuPyNumeric (26.01.00.dev+37.gdb037d19)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/nvidia-sphinx-theme.css?v=933278ad" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/params.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />



    <script src="../_static/documentation_options.js?v=72df31c5"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=4ea706d9"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user/task';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://docs.nvidia.com/cupynumeric/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '26.01';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            true;
        </script>

    <link rel="icon" href="../_static/favicon.png"/>

    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Examples" href="../examples/index.html" />
    <link rel="prev" title="Tutorial" href="tutorial.html" />


<script src="https://assets.adobedtm.com/5d4962a43b79/c1061d2c5e7b/launch-191c2462b890.min.js"></script>


  </head>

  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>


  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="NVIDIA cuPyNumeric (26.01.00.dev+37.gdb037d19) - Home"/>
    <img src="../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="NVIDIA cuPyNumeric (26.01.00.dev+37.gdb037d19) - Home"/>
  
  
    <p class="title logo__title">NVIDIA cuPyNumeric (26.01.00.dev+37.gdb037d19)</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">


<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        



  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="NVIDIA cuPyNumeric (26.01.00.dev+37.gdb037d19) - Home"/>
    <img src="../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="NVIDIA cuPyNumeric (26.01.00.dev+37.gdb037d19) - Home"/>
  
  
    <p class="title logo__title">NVIDIA cuPyNumeric (26.01.00.dev+37.gdb037d19)</p>
  
</a>


  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">


<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">



<nav class="bd-docs-nav bd-links"
     aria-label="Table of Contents">
  <p class="bd-links__title" role="heading" aria-level="1">Table of Contents</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">User guide</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="practices.html">Best practices</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="howtos/index.html">Howtos</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="howtos/measuring.html">Measure API coverage</a></li>
<li class="toctree-l3"><a class="reference internal" href="howtos/benchmarking.html">Performance Benchmarking</a></li>
<li class="toctree-l3"><a class="reference internal" href="howtos/patching.html">Trying Numpy code without changes</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="advanced.html">Advanced topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="differences.html">Differences with Numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Extend cuPyNumeric with Legate-tasks</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/index.html">Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/black_scholes.html">Black-Scholes options pricing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/cholesky.html">Cholesky decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/stencil.html">Jacobi stencil</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/kmeans.html">K-Means Clustering Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/edge_detection.html">Edge Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/newton_raphson_2d.html">Newton Raphson Method In Two Dimensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/compact_finite_difference.html">Compact Finite Difference Scheme</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/torchswe.html">TorchSWE case study</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/classes.html">Classes</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/broadcast.html">cupynumeric.broadcast</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/ndarray.html">The N-Dimensional array (<code class="xref py py-class docutils literal notranslate"><span class="pre">cupynumeric.ndarray</span></code>)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/_ndarray.html">cupynumeric.ndarray</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.all.html">cupynumeric.ndarray.all</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.any.html">cupynumeric.ndarray.any</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.flags.html">cupynumeric.ndarray.flags</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.shape.html">cupynumeric.ndarray.shape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.strides.html">cupynumeric.ndarray.strides</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.ndim.html">cupynumeric.ndarray.ndim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.data.html">cupynumeric.ndarray.data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.size.html">cupynumeric.ndarray.size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.itemsize.html">cupynumeric.ndarray.itemsize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.nbytes.html">cupynumeric.ndarray.nbytes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.base.html">cupynumeric.ndarray.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.ctypes.html">cupynumeric.ndarray.ctypes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.dtype.html">cupynumeric.ndarray.dtype</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.T.html">cupynumeric.ndarray.T</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.real.html">cupynumeric.ndarray.real</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.imag.html">cupynumeric.ndarray.imag</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.flat.html">cupynumeric.ndarray.flat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.item.html">cupynumeric.ndarray.item</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.tolist.html">cupynumeric.ndarray.tolist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.itemset.html">cupynumeric.ndarray.itemset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.tostring.html">cupynumeric.ndarray.tostring</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.tobytes.html">cupynumeric.ndarray.tobytes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.tofile.html">cupynumeric.ndarray.tofile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.dump.html">cupynumeric.ndarray.dump</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.dumps.html">cupynumeric.ndarray.dumps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.astype.html">cupynumeric.ndarray.astype</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.copy.html">cupynumeric.ndarray.copy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.view.html">cupynumeric.ndarray.view</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.getfield.html">cupynumeric.ndarray.getfield</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.setfield.html">cupynumeric.ndarray.setfield</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.setflags.html">cupynumeric.ndarray.setflags</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.fill.html">cupynumeric.ndarray.fill</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.reshape.html">cupynumeric.ndarray.reshape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.transpose.html">cupynumeric.ndarray.transpose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.swapaxes.html">cupynumeric.ndarray.swapaxes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.flatten.html">cupynumeric.ndarray.flatten</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.ravel.html">cupynumeric.ndarray.ravel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.squeeze.html">cupynumeric.ndarray.squeeze</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.take.html">cupynumeric.ndarray.take</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.put.html">cupynumeric.ndarray.put</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.choose.html">cupynumeric.ndarray.choose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.sort.html">cupynumeric.ndarray.sort</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.argsort.html">cupynumeric.ndarray.argsort</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.partition.html">cupynumeric.ndarray.partition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.argpartition.html">cupynumeric.ndarray.argpartition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.searchsorted.html">cupynumeric.ndarray.searchsorted</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.nonzero.html">cupynumeric.ndarray.nonzero</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.compress.html">cupynumeric.ndarray.compress</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.diagonal.html">cupynumeric.ndarray.diagonal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.trace.html">cupynumeric.ndarray.trace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.max.html">cupynumeric.ndarray.max</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.argmax.html">cupynumeric.ndarray.argmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.min.html">cupynumeric.ndarray.min</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.argmin.html">cupynumeric.ndarray.argmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.clip.html">cupynumeric.ndarray.clip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.conj.html">cupynumeric.ndarray.conj</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.conjugate.html">cupynumeric.ndarray.conjugate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.dot.html">cupynumeric.ndarray.dot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.flip.html">cupynumeric.ndarray.flip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.round.html">cupynumeric.ndarray.round</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.sum.html">cupynumeric.ndarray.sum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.cumsum.html">cupynumeric.ndarray.cumsum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.mean.html">cupynumeric.ndarray.mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.var.html">cupynumeric.ndarray.var</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.prod.html">cupynumeric.ndarray.prod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.cumprod.html">cupynumeric.ndarray.cumprod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.all.html">cupynumeric.ndarray.all</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.any.html">cupynumeric.ndarray.any</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.unique.html">cupynumeric.ndarray.unique</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__lt__.html">cupynumeric.ndarray.__lt__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__le__.html">cupynumeric.ndarray.__le__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__gt__.html">cupynumeric.ndarray.__gt__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__ge__.html">cupynumeric.ndarray.__ge__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__eq__.html">cupynumeric.ndarray.__eq__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__ne__.html">cupynumeric.ndarray.__ne__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__bool__.html">cupynumeric.ndarray.__bool__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__neg__.html">cupynumeric.ndarray.__neg__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__pos__.html">cupynumeric.ndarray.__pos__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__abs__.html">cupynumeric.ndarray.__abs__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__invert__.html">cupynumeric.ndarray.__invert__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__add__.html">cupynumeric.ndarray.__add__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__sub__.html">cupynumeric.ndarray.__sub__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__mul__.html">cupynumeric.ndarray.__mul__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__truediv__.html">cupynumeric.ndarray.__truediv__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__floordiv__.html">cupynumeric.ndarray.__floordiv__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__mod__.html">cupynumeric.ndarray.__mod__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__divmod__.html">cupynumeric.ndarray.__divmod__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__pow__.html">cupynumeric.ndarray.__pow__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__lshift__.html">cupynumeric.ndarray.__lshift__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__rshift__.html">cupynumeric.ndarray.__rshift__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__and__.html">cupynumeric.ndarray.__and__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__or__.html">cupynumeric.ndarray.__or__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__xor__.html">cupynumeric.ndarray.__xor__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__iadd__.html">cupynumeric.ndarray.__iadd__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__isub__.html">cupynumeric.ndarray.__isub__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__imul__.html">cupynumeric.ndarray.__imul__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__itruediv__.html">cupynumeric.ndarray.__itruediv__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__ifloordiv__.html">cupynumeric.ndarray.__ifloordiv__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__imod__.html">cupynumeric.ndarray.__imod__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__ipow__.html">cupynumeric.ndarray.__ipow__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__ilshift__.html">cupynumeric.ndarray.__ilshift__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__irshift__.html">cupynumeric.ndarray.__irshift__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__iand__.html">cupynumeric.ndarray.__iand__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__ior__.html">cupynumeric.ndarray.__ior__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__ixor__.html">cupynumeric.ndarray.__ixor__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__matmul__.html">cupynumeric.ndarray.__matmul__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__imatmul__.html">cupynumeric.ndarray.__imatmul__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__rmatmul__.html">cupynumeric.ndarray.__rmatmul__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__copy__.html">cupynumeric.ndarray.__copy__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__deepcopy__.html">cupynumeric.ndarray.__deepcopy__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__index__.html">cupynumeric.ndarray.__index__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__reduce__.html">cupynumeric.ndarray.__reduce__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__setstate__.html">cupynumeric.ndarray.__setstate__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__new__.html">cupynumeric.ndarray.__new__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__array__.html">cupynumeric.ndarray.__array__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__len__.html">cupynumeric.ndarray.__len__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__getitem__.html">cupynumeric.ndarray.__getitem__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__setitem__.html">cupynumeric.ndarray.__setitem__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__contains__.html">cupynumeric.ndarray.__contains__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__int__.html">cupynumeric.ndarray.__int__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__float__.html">cupynumeric.ndarray.__float__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__complex__.html">cupynumeric.ndarray.__complex__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__str__.html">cupynumeric.ndarray.__str__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.__repr__.html">cupynumeric.ndarray.__repr__</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndarray.stencil_hint.html">cupynumeric.ndarray.stencil_hint</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/routines.html">Routines</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/creation.html">Array creation routines</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.empty.html">cupynumeric.empty</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.empty_like.html">cupynumeric.empty_like</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.eye.html">cupynumeric.eye</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.identity.html">cupynumeric.identity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ones.html">cupynumeric.ones</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ones_like.html">cupynumeric.ones_like</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.zeros.html">cupynumeric.zeros</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.zeros_like.html">cupynumeric.zeros_like</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.full.html">cupynumeric.full</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.full_like.html">cupynumeric.full_like</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.array.html">cupynumeric.array</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.asarray.html">cupynumeric.asarray</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.copy.html">cupynumeric.copy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.copyto.html">cupynumeric.copyto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.repeat.html">cupynumeric.repeat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.arange.html">cupynumeric.arange</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.logspace.html">cupynumeric.logspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.linspace.html">cupynumeric.linspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.meshgrid.html">cupynumeric.meshgrid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.diag.html">cupynumeric.diag</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.diagflat.html">cupynumeric.diagflat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.tri.html">cupynumeric.tri</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.tril.html">cupynumeric.tril</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.triu.html">cupynumeric.triu</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/manipulation.html">Array manipulation routines</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ndim.html">cupynumeric.ndim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.shape.html">cupynumeric.shape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.reshape.html">cupynumeric.reshape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ravel.html">cupynumeric.ravel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.moveaxis.html">cupynumeric.moveaxis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.swapaxes.html">cupynumeric.swapaxes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.transpose.html">cupynumeric.transpose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.atleast_1d.html">cupynumeric.atleast_1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.atleast_2d.html">cupynumeric.atleast_2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.atleast_3d.html">cupynumeric.atleast_3d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.broadcast_arrays.html">cupynumeric.broadcast_arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.broadcast_shapes.html">cupynumeric.broadcast_shapes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.broadcast_to.html">cupynumeric.broadcast_to</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.expand_dims.html">cupynumeric.expand_dims</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.squeeze.html">cupynumeric.squeeze</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.asarray.html">cupynumeric.asarray</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.append.html">cupynumeric.append</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.concatenate.html">cupynumeric.concatenate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.insert.html">cupynumeric.insert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.stack.html">cupynumeric.stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.block.html">cupynumeric.block</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.vstack.html">cupynumeric.vstack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.hstack.html">cupynumeric.hstack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.dstack.html">cupynumeric.dstack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.column_stack.html">cupynumeric.column_stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.row_stack.html">cupynumeric.row_stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.split.html">cupynumeric.split</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.array_split.html">cupynumeric.array_split</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.dsplit.html">cupynumeric.dsplit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.hsplit.html">cupynumeric.hsplit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.vsplit.html">cupynumeric.vsplit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.tile.html">cupynumeric.tile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.flip.html">cupynumeric.flip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fliplr.html">cupynumeric.fliplr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.flipud.html">cupynumeric.flipud</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.roll.html">cupynumeric.roll</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.rot90.html">cupynumeric.rot90</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.delete.html">cupynumeric.delete</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/binary.html">Binary operations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.bitwise_and.html">cupynumeric.bitwise_and</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.bitwise_or.html">cupynumeric.bitwise_or</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.bitwise_xor.html">cupynumeric.bitwise_xor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.invert.html">cupynumeric.invert</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.left_shift.html">cupynumeric.left_shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.right_shift.html">cupynumeric.right_shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.packbits.html">cupynumeric.packbits</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.unpackbits.html">cupynumeric.unpackbits</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/datatype.html">Data type routines</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.find_common_type.html">cupynumeric.find_common_type</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/indexing.html">Indexing routines</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.unravel_index.html">cupynumeric.unravel_index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.diag_indices.html">cupynumeric.diag_indices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.diag_indices_from.html">cupynumeric.diag_indices_from</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.mask_indices.html">cupynumeric.mask_indices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.tril_indices.html">cupynumeric.tril_indices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.tril_indices_from.html">cupynumeric.tril_indices_from</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.triu_indices.html">cupynumeric.triu_indices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.triu_indices_from.html">cupynumeric.triu_indices_from</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.indices.html">cupynumeric.indices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ix_.html">cupynumeric.ix_</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.nonzero.html">cupynumeric.nonzero</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.flatnonzero.html">cupynumeric.flatnonzero</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.where.html">cupynumeric.where</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ravel_multi_index.html">cupynumeric.ravel_multi_index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.choose.html">cupynumeric.choose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.compress.html">cupynumeric.compress</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.diag.html">cupynumeric.diag</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.diagonal.html">cupynumeric.diagonal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.select.html">cupynumeric.select</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.take.html">cupynumeric.take</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.take_along_axis.html">cupynumeric.take_along_axis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fill_diagonal.html">cupynumeric.fill_diagonal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.put.html">cupynumeric.put</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.putmask.html">cupynumeric.putmask</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.put_along_axis.html">cupynumeric.put_along_axis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.place.html">cupynumeric.place</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/io.html">Input and output</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.load.html">cupynumeric.load</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/linalg.html">Linear algebra (<code class="xref py py-mod docutils literal notranslate"><span class="pre">cupynumeric.linalg</span></code>)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.dot.html">cupynumeric.dot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.vdot.html">cupynumeric.vdot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.inner.html">cupynumeric.inner</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.outer.html">cupynumeric.outer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.matmul.html">cupynumeric.matmul</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.tensordot.html">cupynumeric.tensordot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.einsum.html">cupynumeric.einsum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.einsum_path.html">cupynumeric.einsum_path</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.linalg.matrix_power.html">cupynumeric.linalg.matrix_power</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.linalg.multi_dot.html">cupynumeric.linalg.multi_dot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.linalg.cholesky.html">cupynumeric.linalg.cholesky</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.linalg.eig.html">cupynumeric.linalg.eig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.linalg.eigh.html">cupynumeric.linalg.eigh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.linalg.eigvals.html">cupynumeric.linalg.eigvals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.linalg.eigvalsh.html">cupynumeric.linalg.eigvalsh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.linalg.qr.html">cupynumeric.linalg.qr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.linalg.svd.html">cupynumeric.linalg.svd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.linalg.norm.html">cupynumeric.linalg.norm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.trace.html">cupynumeric.trace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.linalg.solve.html">cupynumeric.linalg.solve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.linalg.pinv.html">cupynumeric.linalg.pinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.linalg.expm.html">cupynumeric.linalg.expm</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/logic.html">Logic functions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.all.html">cupynumeric.all</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.any.html">cupynumeric.any</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.isfinite.html">cupynumeric.isfinite</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.isinf.html">cupynumeric.isinf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.isnan.html">cupynumeric.isnan</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.isneginf.html">cupynumeric.isneginf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.isposinf.html">cupynumeric.isposinf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.iscomplex.html">cupynumeric.iscomplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.iscomplexobj.html">cupynumeric.iscomplexobj</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.isreal.html">cupynumeric.isreal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.isrealobj.html">cupynumeric.isrealobj</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.isscalar.html">cupynumeric.isscalar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.logical_and.html">cupynumeric.logical_and</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.logical_or.html">cupynumeric.logical_or</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.logical_not.html">cupynumeric.logical_not</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.logical_xor.html">cupynumeric.logical_xor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.allclose.html">cupynumeric.allclose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.isclose.html">cupynumeric.isclose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.array_equal.html">cupynumeric.array_equal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.greater.html">cupynumeric.greater</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.greater_equal.html">cupynumeric.greater_equal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.less.html">cupynumeric.less</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.less_equal.html">cupynumeric.less_equal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.equal.html">cupynumeric.equal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.not_equal.html">cupynumeric.not_equal</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/math.html">Mathematical functions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.sin.html">cupynumeric.sin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.cos.html">cupynumeric.cos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.tan.html">cupynumeric.tan</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.arcsin.html">cupynumeric.arcsin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.arccos.html">cupynumeric.arccos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.arctan.html">cupynumeric.arctan</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.hypot.html">cupynumeric.hypot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.arctan2.html">cupynumeric.arctan2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.degrees.html">cupynumeric.degrees</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.radians.html">cupynumeric.radians</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.deg2rad.html">cupynumeric.deg2rad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.rad2deg.html">cupynumeric.rad2deg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.sinh.html">cupynumeric.sinh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.cosh.html">cupynumeric.cosh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.tanh.html">cupynumeric.tanh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.arcsinh.html">cupynumeric.arcsinh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.arccosh.html">cupynumeric.arccosh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.arctanh.html">cupynumeric.arctanh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.round.html">cupynumeric.round</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.rint.html">cupynumeric.rint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.floor.html">cupynumeric.floor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ceil.html">cupynumeric.ceil</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.trunc.html">cupynumeric.trunc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.prod.html">cupynumeric.prod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.sum.html">cupynumeric.sum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.cumprod.html">cupynumeric.cumprod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.cumsum.html">cupynumeric.cumsum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.diff.html">cupynumeric.diff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.nancumprod.html">cupynumeric.nancumprod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.nancumsum.html">cupynumeric.nancumsum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.nanprod.html">cupynumeric.nanprod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.nansum.html">cupynumeric.nansum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.gradient.html">cupynumeric.gradient</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.cross.html">cupynumeric.cross</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.exp.html">cupynumeric.exp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.expm1.html">cupynumeric.expm1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.exp2.html">cupynumeric.exp2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.log.html">cupynumeric.log</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.log10.html">cupynumeric.log10</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.log2.html">cupynumeric.log2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.log1p.html">cupynumeric.log1p</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.logaddexp.html">cupynumeric.logaddexp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.logaddexp2.html">cupynumeric.logaddexp2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.signbit.html">cupynumeric.signbit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.copysign.html">cupynumeric.copysign</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.frexp.html">cupynumeric.frexp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.ldexp.html">cupynumeric.ldexp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.nextafter.html">cupynumeric.nextafter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.lcm.html">cupynumeric.lcm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.gcd.html">cupynumeric.gcd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.add.html">cupynumeric.add</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.reciprocal.html">cupynumeric.reciprocal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.positive.html">cupynumeric.positive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.negative.html">cupynumeric.negative</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.multiply.html">cupynumeric.multiply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.divide.html">cupynumeric.divide</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.power.html">cupynumeric.power</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.subtract.html">cupynumeric.subtract</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.true_divide.html">cupynumeric.true_divide</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.floor_divide.html">cupynumeric.floor_divide</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.float_power.html">cupynumeric.float_power</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fmod.html">cupynumeric.fmod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.mod.html">cupynumeric.mod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.modf.html">cupynumeric.modf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.remainder.html">cupynumeric.remainder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.real.html">cupynumeric.real</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.real_if_close.html">cupynumeric.real_if_close</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.imag.html">cupynumeric.imag</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.angle.html">cupynumeric.angle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.conj.html">cupynumeric.conj</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.conjugate.html">cupynumeric.conjugate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.maximum.html">cupynumeric.maximum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fmax.html">cupynumeric.fmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.amax.html">cupynumeric.amax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.minimum.html">cupynumeric.minimum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fmin.html">cupynumeric.fmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.amin.html">cupynumeric.amin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.nanmin.html">cupynumeric.nanmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.nanmax.html">cupynumeric.nanmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.convolve.html">cupynumeric.convolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.clip.html">cupynumeric.clip</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.nan_to_num.html">cupynumeric.nan_to_num</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.sqrt.html">cupynumeric.sqrt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.cbrt.html">cupynumeric.cbrt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.square.html">cupynumeric.square</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.roots.html">cupynumeric.roots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.absolute.html">cupynumeric.absolute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fabs.html">cupynumeric.fabs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.sign.html">cupynumeric.sign</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.inner.html">cupynumeric.inner</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.outer.html">cupynumeric.outer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.vdot.html">cupynumeric.vdot</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/fft.html">Discrete Fourier Transform (<code class="xref py py-mod docutils literal notranslate"><span class="pre">cupynumeric.fft</span></code>)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fft.fft.html">cupynumeric.fft.fft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fft.ifft.html">cupynumeric.fft.ifft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fft.fft2.html">cupynumeric.fft.fft2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fft.ifft2.html">cupynumeric.fft.ifft2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fft.fftn.html">cupynumeric.fft.fftn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fft.ifftn.html">cupynumeric.fft.ifftn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fft.rfft.html">cupynumeric.fft.rfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fft.irfft.html">cupynumeric.fft.irfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fft.rfft2.html">cupynumeric.fft.rfft2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fft.irfft2.html">cupynumeric.fft.irfft2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fft.rfftn.html">cupynumeric.fft.rfftn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fft.irfftn.html">cupynumeric.fft.irfftn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fft.hfft.html">cupynumeric.fft.hfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fft.ihfft.html">cupynumeric.fft.ihfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fft.fftshift.html">cupynumeric.fft.fftshift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.fft.ifftshift.html">cupynumeric.fft.ifftshift</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/random.html">Random sampling (<code class="xref py py-mod docutils literal notranslate"><span class="pre">cupynumeric.random</span></code>)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.default_rng.html">cupynumeric.random.default_rng</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/_generator.html">cupynumeric.random.Generator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/_bitgenerator.html">cupynumeric.random.BitGenerator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.seed.html">cupynumeric.random.seed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.default_rng.html">cupynumeric.random.default_rng</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.rand.html">cupynumeric.random.rand</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.randn.html">cupynumeric.random.randn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.randint.html">cupynumeric.random.randint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.random.html">cupynumeric.random.random</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.random_integers.html">cupynumeric.random.random_integers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.random_sample.html">cupynumeric.random.random_sample</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.bytes.html">cupynumeric.random.bytes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.beta.html">cupynumeric.random.beta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.binomial.html">cupynumeric.random.binomial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.chisquare.html">cupynumeric.random.chisquare</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.exponential.html">cupynumeric.random.exponential</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.f.html">cupynumeric.random.f</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.gamma.html">cupynumeric.random.gamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.geometric.html">cupynumeric.random.geometric</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.gumbel.html">cupynumeric.random.gumbel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.hypergeometric.html">cupynumeric.random.hypergeometric</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.laplace.html">cupynumeric.random.laplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.logistic.html">cupynumeric.random.logistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.lognormal.html">cupynumeric.random.lognormal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.logseries.html">cupynumeric.random.logseries</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.negative_binomial.html">cupynumeric.random.negative_binomial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.noncentral_chisquare.html">cupynumeric.random.noncentral_chisquare</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.noncentral_f.html">cupynumeric.random.noncentral_f</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.normal.html">cupynumeric.random.normal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.pareto.html">cupynumeric.random.pareto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.poisson.html">cupynumeric.random.poisson</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.power.html">cupynumeric.random.power</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.ranf.html">cupynumeric.random.ranf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.rayleigh.html">cupynumeric.random.rayleigh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.sample.html">cupynumeric.random.sample</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.standard_cauchy.html">cupynumeric.random.standard_cauchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.standard_exponential.html">cupynumeric.random.standard_exponential</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.standard_gamma.html">cupynumeric.random.standard_gamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.standard_t.html">cupynumeric.random.standard_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.triangular.html">cupynumeric.random.triangular</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.uniform.html">cupynumeric.random.uniform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.vonmises.html">cupynumeric.random.vonmises</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.wald.html">cupynumeric.random.wald</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.weibull.html">cupynumeric.random.weibull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.random.zipf.html">cupynumeric.random.zipf</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/set.html">Set routines</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.unique.html">cupynumeric.unique</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.in1d.html">cupynumeric.in1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.isin.html">cupynumeric.isin</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/sorting.html">Sorting, searching, and counting</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.argpartition.html">cupynumeric.argpartition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.argsort.html">cupynumeric.argsort</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.partition.html">cupynumeric.partition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.sort.html">cupynumeric.sort</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.sort_complex.html">cupynumeric.sort_complex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.argmax.html">cupynumeric.argmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.argmin.html">cupynumeric.argmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.argwhere.html">cupynumeric.argwhere</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.flatnonzero.html">cupynumeric.flatnonzero</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.nanargmax.html">cupynumeric.nanargmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.nanargmin.html">cupynumeric.nanargmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.nonzero.html">cupynumeric.nonzero</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.searchsorted.html">cupynumeric.searchsorted</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.extract.html">cupynumeric.extract</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.where.html">cupynumeric.where</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.count_nonzero.html">cupynumeric.count_nonzero</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/statistics.html">Statistics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.quantile.html">cupynumeric.quantile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.percentile.html">cupynumeric.percentile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.nanquantile.html">cupynumeric.nanquantile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.nanpercentile.html">cupynumeric.nanpercentile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.average.html">cupynumeric.average</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.mean.html">cupynumeric.mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.nanmean.html">cupynumeric.nanmean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.var.html">cupynumeric.var</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.median.html">cupynumeric.median</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.nanmedian.html">cupynumeric.nanmedian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.cov.html">cupynumeric.cov</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.bincount.html">cupynumeric.bincount</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.histogram.html">cupynumeric.histogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.histogram2d.html">cupynumeric.histogram2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.histogramdd.html">cupynumeric.histogramdd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.digitize.html">cupynumeric.digitize</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/window.html">Window functions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.bartlett.html">cupynumeric.bartlett</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.blackman.html">cupynumeric.blackman</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.hamming.html">cupynumeric.hamming</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.hanning.html">cupynumeric.hanning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/cupynumeric.kaiser.html">cupynumeric.kaiser</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../api/settings.html">Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/comparison.html">Project comparisons</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../faqs.html">Frequently Asked Questions</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../developer/index.html">Developer guide</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer/CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/building.html">Building from source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/testing.html">Running tests</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgments.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oss-licenses.html">Third-party notices</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>



      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">User guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Extend cuPyNumeric with Legate-tasks</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="extend-cupynumeric-with-legate-tasks">
<span id="legate-tasks"></span><h1>Extend cuPyNumeric with Legate-tasks<a class="headerlink" href="#extend-cupynumeric-with-legate-tasks" title="Link to this heading">#</a></h1>
<p>This tutorial assumes familiarity with the basic usage of cuPyNumeric.
Certain scenarios may benefit from building custom functions to integrate with
cuPyNumeric, for example: implementing novel research algorithms, or
leveraging routines from other libraries while still taking advantage of
transparent scaling. In these cases, Legate tasks can be used to extend
cuPyNumeric by defining scaleout functions that enable new algorithms
to run seamlessly across distributed resources.</p>
<section id="what-is-a-legate-task">
<h2>What is a Legate task?<a class="headerlink" href="#what-is-a-legate-task" title="Link to this heading">#</a></h2>
<p>A Legate task is a Python function annotated with the <code class="docutils literal notranslate"><span class="pre">&#64;legate.core.task.task</span></code>
decorator. This decorator informs the Legate runtime that a function
represents a parallel task that can be distributed across multiple CPUs,
GPUs, and nodes. This decorator enables high-performance parallelism
with a simple Python syntax.</p>
<p>Legate tasks are available automatically when using cuPyNumeric. No
additional components are needed after cuPyNumeric is installed.
Please refer to the <a class="reference external" href="https://github.com/NVIDIA/accelerated-computing-hub/blob/main/Accelerated_Python_User_Guide/notebooks/Chapter_11_Distributed_Computing_cuPyNumeric.ipynb">Distributed Computing with cuPyNumeric</a> for cuPyNumeric installation.</p>
<section id="quick-example">
<h3>Quick example<a class="headerlink" href="#quick-example" title="Link to this heading">#</a></h3>
<p>Here is an example of defining and invoking a Legate task with a custom function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cupynumeric</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cpn</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">legate.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">TaskContext</span><span class="p">,</span> <span class="n">VariantCode</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">legate.core.task</span><span class="w"> </span><span class="kn">import</span> <span class="n">task</span><span class="p">,</span> <span class="n">InputArray</span><span class="p">,</span> <span class="n">OutputArray</span>


<span class="nd">@task</span><span class="p">(</span><span class="n">variants</span><span class="o">=</span><span class="p">(</span><span class="n">VariantCode</span><span class="o">.</span><span class="n">CPU</span><span class="p">,</span> <span class="n">VariantCode</span><span class="o">.</span><span class="n">GPU</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">simple_in_out</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">TaskContext</span><span class="p">,</span> <span class="n">in_store</span><span class="p">:</span> <span class="n">InputArray</span><span class="p">,</span> <span class="n">out_store</span><span class="p">:</span> <span class="n">OutputArray</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">cupy</span> <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_variant_kind</span><span class="p">()</span> <span class="o">==</span> <span class="n">VariantCode</span><span class="o">.</span><span class="n">GPU</span> <span class="k">else</span> <span class="n">numpy</span>
    <span class="n">in_store</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">in_store</span><span class="p">)</span>
    <span class="n">out_store</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out_store</span><span class="p">)</span>
    <span class="n">out_store</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">in_store</span><span class="p">[:]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">in_arr</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cpn</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
    <span class="n">out_arr</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cpn</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
    <span class="n">simple_in_out</span><span class="p">(</span><span class="n">in_arr</span><span class="p">,</span> <span class="n">out_arr</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">out_arr</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<section id="understanding-this-example">
<h4>Understanding this example<a class="headerlink" href="#understanding-this-example" title="Link to this heading">#</a></h4>
<p>The code runs a function that replaces the contents of the
output array with the contents of the input array. cuPyNumeric arrays,
like <code class="docutils literal notranslate"><span class="pre">in_arr</span></code> and <code class="docutils literal notranslate"><span class="pre">out_arr</span></code> are similar to NumPy arrays but are
backed by Legate stores for parallel execution across CPUs and GPUs.
When these arrays are passed into the <code class="docutils literal notranslate"><span class="pre">foo_in_out</span></code> task, they are
automatically converted into Legate-compatible objects such as
<code class="docutils literal notranslate"><span class="pre">InputStore</span></code> or <code class="docutils literal notranslate"><span class="pre">OutputStore</span></code>, depending on how they are used in the task.
In Legate, arguments representing a portion of a logical store or array must be
specified as one of the following types: <code class="docutils literal notranslate"><span class="pre">InputStore</span></code>, <code class="docutils literal notranslate"><span class="pre">OutputStore</span></code>, <code class="docutils literal notranslate"><span class="pre">InputArray</span></code>, or
<code class="docutils literal notranslate"><span class="pre">OutputArray</span></code> (see <a class="reference external" href="https://docs.nvidia.com/legate/latest/api/python/generated/legate.core.task.InputStore.html">Arguments</a>).
Legate has built-in datatypes suitable for building richer
distributed data structures, e.g. nullable arrays, but in this tutorial
we exclusively use the simpler Legate Store class, which can only
represent a dense array. This is sufficient to back a cuPyNumeric
ndarray.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;task</span></code> decorator declares that this task has two variants: <code class="docutils literal notranslate"><span class="pre">VariantCode.CPU</span></code> for CPU execution
and <code class="docutils literal notranslate"><span class="pre">VariantCode.GPU</span></code> for GPU execution. This means the task can run
on either device, depending on which resources the user selects at runtime.
For more details about Legate task behavior, see <a class="reference external" href="https://docs.nvidia.com/legate/latest/api/python/generated/legate.core.task.task.html">legate_task</a>. Inside
the task, <code class="docutils literal notranslate"><span class="pre">TaskContext</span></code> provides access to the execution environment,
including inputs, outputs, and the execution target (CPU or GPU). The
method <code class="docutils literal notranslate"><span class="pre">ctx.get_variant_kind()</span></code> is used to determine the target device,
and based on this, the variable <code class="docutils literal notranslate"><span class="pre">xp</span></code> is set to either the CuPy for GPU
execution or NumPy for CPU execution. Using <code class="docutils literal notranslate"><span class="pre">xp</span></code>, the task creates views
of the task-local partitions of the Legate-backed global input and
output arrays as either CuPy or NumPy arrays.</p>
</section>
</section>
</section>
<section id="saxpy-problem">
<h2>SAXPY problem<a class="headerlink" href="#saxpy-problem" title="Link to this heading">#</a></h2>
<p>SAXPY (Single-Precision AX Plus Y) is a fundamental linear algebra operation that computes the result
of the expression <span class="math notranslate nohighlight">\(z = a * x + y\)</span>, where <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are vectors and <span class="math notranslate nohighlight">\(a\)</span> is a scalar.
It is a widely used example due to its simplicity and
computational relevance. This example demonstrates how to implement
SAXPY using Legate and cuPyNumeric, with emphasis on leveraging <code class="docutils literal notranslate"><span class="pre">align</span></code>
constraint for correct and efficient parallel execution. The <code class="docutils literal notranslate"><span class="pre">align</span></code>
constraint ensures that the input arrays <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>, as well as the output
<code class="docutils literal notranslate"><span class="pre">z</span></code>, are partitioned consistently. This means that matching elements from
each array are processed together on the same device. As a result, the
element-wise calculation <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">*</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">y</span></code> can run in parallel correctly,
without needing to move data between different parts of the system.</p>
<section id="main-function">
<h3>Main function<a class="headerlink" href="#main-function" title="Link to this heading">#</a></h3>
<p>Lets take a look at the input and output parameters for this SAXPY example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">size</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">size</span>

    <span class="n">x_global</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cpn</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">y_global</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cpn</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">z_global</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cpn</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

    <span class="c1"># Warm-up run</span>
    <span class="n">saxpy_task</span><span class="p">(</span><span class="n">x_global</span><span class="p">,</span> <span class="n">y_global</span><span class="p">,</span> <span class="n">z_global</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
<p>For this example, three one-dimensional arrays of default size 1000 are
created. <code class="docutils literal notranslate"><span class="pre">x_global</span></code> contains values from 0 to 999, <code class="docutils literal notranslate"><span class="pre">y_global</span></code> is filled with
ones, and <code class="docutils literal notranslate"><span class="pre">z_global</span></code> is initialized with zeros to store the result. The
saxpy_task function is then called to compute the operation <code class="docutils literal notranslate"><span class="pre">z_global</span> <span class="pre">=</span> <span class="pre">2.0</span> <span class="pre">*</span> <span class="pre">x_global</span> <span class="pre">+</span> <span class="pre">y_global</span></code>. We can change the size of the arrays
through the <code class="docutils literal notranslate"><span class="pre">--size</span></code> command-line argument when running the script.</p>
</section>
<section id="task-function">
<h3>Task function<a class="headerlink" href="#task-function" title="Link to this heading">#</a></h3>
<p>The following example shows how to define a task function that performs the SAXPY operation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@task</span><span class="p">(</span>
    <span class="n">variants</span><span class="o">=</span><span class="p">(</span><span class="n">VariantCode</span><span class="o">.</span><span class="n">CPU</span><span class="p">,</span> <span class="n">VariantCode</span><span class="o">.</span><span class="n">GPU</span><span class="p">),</span>
    <span class="n">constraints</span><span class="o">=</span><span class="p">(</span><span class="n">align</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">),</span> <span class="n">align</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">)),</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">saxpy_task</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">TaskContext</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">InputArray</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">InputArray</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">OutputArray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">cupy</span> <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_variant_kind</span><span class="p">()</span> <span class="o">==</span> <span class="n">VariantCode</span><span class="o">.</span><span class="n">GPU</span> <span class="k">else</span> <span class="n">numpy</span>
    <span class="n">x_local</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">y_local</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">z_local</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">z_local</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x_local</span> <span class="o">+</span> <span class="n">y_local</span>


</pre></div>
</div>
<p>The constraint used is <code class="docutils literal notranslate"><span class="pre">align</span></code>, it is used to ensure that <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code> , and <code class="docutils literal notranslate"><span class="pre">z</span></code>
are partitioned in the same way. This is so that corresponding elements
live together on the same device. For example, imagine there are 4 GPUs,
and the problem size is 1000.</p>
<ul class="simple">
<li><p>GPU 1 gets the range 0249</p></li>
<li><p>GPU 2 gets the range 250499</p></li>
<li><p>GPU 3 gets the range 500749</p></li>
<li><p>GPU 4 gets the range 750999</p></li>
</ul>
<p>With the usage of <code class="docutils literal notranslate"><span class="pre">align(x,</span> <span class="pre">y)</span></code> and <code class="docutils literal notranslate"><span class="pre">align(y,</span> <span class="pre">z)</span></code> constraints, we ensure that
the chunks of <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, and <code class="docutils literal notranslate"><span class="pre">z</span></code> are partitioned in the same way across devices.
This means that each chunk (or window) of data is assigned to the same task, so corresponding
elements within each chunk are colocated on the same GPU during execution. For example,
if a chunk covering indices 09 is assigned to GPU 1, all data for x[0:10], y[0:10], and z[0:10]
will be processed together on that device. For further details, see the <a class="reference external" href="https://docs.nvidia.com/legate/25.07/api/python/generated/legate.core.task.task.html">Legate alignment constraints documentation</a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">saxpy_task</span></code> function uses <code class="docutils literal notranslate"><span class="pre">TaskContext</span></code> and its <code class="docutils literal notranslate"><span class="pre">get_variant_kind()</span></code>
method to determine the execution target (GPU or CPU) and accordingly
create views of the task-local data as NumPy or CuPy arrays. It then performs the SAXPY operation element-wise by computing
<code class="docutils literal notranslate"><span class="pre">z_local[:]</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">*</span> <span class="pre">x_local</span> <span class="pre">+</span> <span class="pre">y_local</span></code>. This task runs in parallel on the
available hardware (CPU or GPU), enabling efficient computation.</p>
</section>
<section id="complete-module">
<h3>Complete module<a class="headerlink" href="#complete-module" title="Link to this heading">#</a></h3>
<p>Putting the pieces above together, here is a complete module that
can be run with the <code class="docutils literal notranslate"><span class="pre">legate</span></code> command line launcher:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cupynumeric</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cpn</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">legate.core</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">lg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">legate.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">align</span><span class="p">,</span> <span class="n">VariantCode</span><span class="p">,</span> <span class="n">TaskContext</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">legate.core.task</span><span class="w"> </span><span class="kn">import</span> <span class="n">InputArray</span><span class="p">,</span> <span class="n">OutputArray</span><span class="p">,</span> <span class="n">task</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">legate.timing</span><span class="w"> </span><span class="kn">import</span> <span class="n">time</span>


<span class="c1"># [saxpy-start]</span>
<span class="nd">@task</span><span class="p">(</span>
    <span class="n">variants</span><span class="o">=</span><span class="p">(</span><span class="n">VariantCode</span><span class="o">.</span><span class="n">CPU</span><span class="p">,</span> <span class="n">VariantCode</span><span class="o">.</span><span class="n">GPU</span><span class="p">),</span>
    <span class="n">constraints</span><span class="o">=</span><span class="p">(</span><span class="n">align</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">),</span> <span class="n">align</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">)),</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">saxpy_task</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">TaskContext</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">InputArray</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">InputArray</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">OutputArray</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">cupy</span> <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_variant_kind</span><span class="p">()</span> <span class="o">==</span> <span class="n">VariantCode</span><span class="o">.</span><span class="n">GPU</span> <span class="k">else</span> <span class="n">numpy</span>
    <span class="n">x_local</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">y_local</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">z_local</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">z_local</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x_local</span> <span class="o">+</span> <span class="n">y_local</span>


<span class="c1"># [saxpy-end]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Run SAXPY operation.&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--size&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Size of input arrays&quot;</span>
    <span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="c1"># [input-section]</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">size</span>

    <span class="n">x_global</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cpn</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">y_global</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cpn</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">z_global</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cpn</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

    <span class="c1"># Warm-up run</span>
    <span class="n">saxpy_task</span><span class="p">(</span><span class="n">x_global</span><span class="p">,</span> <span class="n">y_global</span><span class="p">,</span> <span class="n">z_global</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
    <span class="c1"># [function-call]</span>

    <span class="n">rt</span> <span class="o">=</span> <span class="n">lg</span><span class="o">.</span><span class="n">get_legate_runtime</span><span class="p">()</span>
    <span class="n">rt</span><span class="o">.</span><span class="n">issue_execution_fence</span><span class="p">()</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

    <span class="n">saxpy_task</span><span class="p">(</span><span class="n">x_global</span><span class="p">,</span> <span class="n">y_global</span><span class="p">,</span> <span class="n">z_global</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>

    <span class="n">rt</span><span class="o">.</span><span class="n">issue_execution_fence</span><span class="p">()</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Time elapsed for saxpy: </span><span class="si">{</span><span class="p">(</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> milliseconds&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>The Legate runtime is used in the main function to control and
synchronize task execution. The <code class="docutils literal notranslate"><span class="pre">get_legate_runtime()</span></code> function returns
this runtime, which is used to issue commands like execution fences. In
this example, <code class="docutils literal notranslate"><span class="pre">issue_execution_fence()</span></code> is called before and after the
<code class="docutils literal notranslate"><span class="pre">saxpy_task</span></code> to ensure accurate time measurement. Since Legate tasks run
asynchronously by default, these fences make the program wait until all
previous tasks have finished, so the measured time reflects only the
actual task execution. This is a common pattern when precise timing,
synchronization, or ordered execution of asynchronous tasks is needed.</p>
<p>GPU initialization has a fixed setup time that can significantly affect
the runtime when processing small arrays. Using a large input (e.g., 100
million elements) ensures that the computation time outweighs the
startup overhead, giving more realistic timing results. Since the first
GPU run may include the setup overhead like compilation or memory
allocation, a warm-up pass helps eliminate these one-time costs from
performance measurements, ensuring more reliable results.</p>
</section>
<section id="running-on-cpu-and-gpu">
<h3>Running on CPU and GPU<a class="headerlink" href="#running-on-cpu-and-gpu" title="Link to this heading">#</a></h3>
<p>In order to run the program, use the legate launcher, and include any
flags necessary like <code class="docutils literal notranslate"><span class="pre">--cpus</span></code>, <code class="docutils literal notranslate"><span class="pre">--gpus</span></code>, and more. If you want to run
specifically only on CPU, you must include the flag <code class="docutils literal notranslate"><span class="pre">--gpus</span> <span class="pre">0</span></code>.
For a complete guide and additional options, see the <a class="reference external" href="https://docs.nvidia.com/legate/latest/usage.html">Legate documentation</a>.</p>
<p>Lets set the input array size to 10 million elements to better
evaluate the speedup from distributed computing with GPUs.</p>
<section id="cpu-execution">
<h4>CPU execution<a class="headerlink" href="#cpu-execution" title="Link to this heading">#</a></h4>
<p>To run with CPU, use the following command.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>legate<span class="w"> </span>--cpus<span class="w"> </span><span class="m">1</span><span class="w"> </span>--gpus<span class="w"> </span><span class="m">0</span><span class="w"> </span>./saxpy.py<span class="w"> </span>--size<span class="w"> </span><span class="m">10000000</span>
</pre></div>
</div>
<p>This produces the following output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Time elapsed for saxpy: 14.303000 milliseconds
</pre></div>
</div>
</section>
<section id="gpu-execution">
<h4>GPU execution<a class="headerlink" href="#gpu-execution" title="Link to this heading">#</a></h4>
<p>To run with GPU, use the following command.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>legate<span class="w"> </span>--gpus<span class="w"> </span><span class="m">2</span><span class="w"> </span>./saxpy.py<span class="w"> </span>--size<span class="w"> </span><span class="m">10000000</span>
</pre></div>
</div>
<p>This produces the following output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Time elapsed for saxpy : 1.769000 milliseconds
</pre></div>
</div>
</section>
<section id="multi-node-execution">
<h4>Multi-Node execution<a class="headerlink" href="#multi-node-execution" title="Link to this heading">#</a></h4>
<p>Refer to the Legate documentation on how to run on <a class="reference external" href="https://docs.nvidia.com/legate/latest/usage.html">multi-node</a>.
Here is an example performed on the <a class="reference external" href="https://docs.nersc.gov/systems/perlmutter/architecture/">Perlmutter</a> supercomputer.</p>
<p>To run on multi-node, use the following command.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>legate<span class="w"> </span>--nodes<span class="w"> </span><span class="m">2</span><span class="w"> </span>--launcher<span class="w"> </span>srun<span class="w"> </span>--gpus<span class="w"> </span><span class="m">4</span><span class="w"> </span>--ranks-per-node<span class="w"> </span><span class="m">1</span><span class="w"> </span>./saxpy.py<span class="w"> </span>--size<span class="w"> </span><span class="m">10000000</span>
</pre></div>
</div>
<p>This produces the following output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Time elapsed for saxpy : 2.052000 milliseconds
</pre></div>
</div>
</section>
</section>
</section>
<section id="histogram-problem">
<h2>Histogram problem<a class="headerlink" href="#histogram-problem" title="Link to this heading">#</a></h2>
<p>Histogram computation involves counting how many data points fall into
specific bins, This is useful in tasks like statistical analysis and
image processing. In this example, Legate and cuPyNumeric are used to compute a
histogram in parallel, with a key focus on the <code class="docutils literal notranslate"><span class="pre">broadcast</span></code> constraint.
Broadcasting ensures that the histogram array is not split across
devices, allowing each GPU to access the full array and update it
safely. This prevents partial updates and ensures correct aggregation
using Legates reduction mechanism, enabling accurate and efficient
parallel histogram computation.</p>
<section id="main-function-1">
<span id="id1"></span><h3>Main function<a class="headerlink" href="#main-function-1" title="Link to this heading">#</a></h3>
<p>Lets take a quick look at the input and output parameters for this histogram example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">size</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">size</span>
    <span class="n">NUM_BINS</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">NUM_BINS</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">size</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cpn</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
    <span class="n">hist</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">NUM_BINS</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cpn</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

    <span class="n">histogram_task</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">hist</span><span class="p">,</span> <span class="n">NUM_BINS</span><span class="p">)</span>
</pre></div>
</div>
<p>For this example, a one-dimensional array with a default size of 1000
elements is created, filled with random integers ranging from 0 to 9.
Alongside that, an empty <code class="docutils literal notranslate"><span class="pre">hist</span></code> array of length 10 is prepared to store
counts. The <code class="docutils literal notranslate"><span class="pre">histogram_task</span></code> function is then called to count the
frequency of each integer in the <code class="docutils literal notranslate"><span class="pre">data</span></code> array and accumulate these counts
into the <code class="docutils literal notranslate"><span class="pre">hist</span></code> array. We can change the size of the input array through
the <code class="docutils literal notranslate"><span class="pre">--size</span></code> command-line argument when running the script</p>
</section>
<section id="id2">
<h3>Task function<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>The following example defines a histogram task function that computes a local histogram and accumulates the results into a global <code class="docutils literal notranslate"><span class="pre">hist</span></code> array using a reduction.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@task</span><span class="p">(</span>
    <span class="n">variants</span><span class="o">=</span><span class="p">(</span><span class="n">VariantCode</span><span class="o">.</span><span class="n">CPU</span><span class="p">,</span> <span class="n">VariantCode</span><span class="o">.</span><span class="n">GPU</span><span class="p">),</span>
    <span class="n">constraints</span><span class="o">=</span><span class="p">(</span><span class="n">broadcast</span><span class="p">(</span><span class="s2">&quot;hist&quot;</span><span class="p">),),</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">histogram_task</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">TaskContext</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">InputArray</span><span class="p">,</span> <span class="n">hist</span><span class="p">:</span> <span class="n">ReductionArray</span><span class="p">[</span><span class="n">ADD</span><span class="p">],</span> <span class="n">N_bins</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">cupy</span> <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_variant_kind</span><span class="p">()</span> <span class="o">==</span> <span class="n">VariantCode</span><span class="o">.</span><span class="n">GPU</span> <span class="k">else</span> <span class="n">numpy</span>
    <span class="n">data_local</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">hist_local</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>

    <span class="n">local_hist</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">data_local</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">N_bins</span><span class="p">)</span>
    <span class="n">hist_local</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">hist_local</span> <span class="o">+</span> <span class="n">local_hist</span>


</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">histogram_task</span></code> function uses <code class="docutils literal notranslate"><span class="pre">TaskContext</span></code> and its <code class="docutils literal notranslate"><span class="pre">get_variant_kind()</span></code>
method to determine the execution target (GPU or CPU) and accordingly
create views of the task-local data as NumPy or CuPy arrays. It then
computes a local histogram on the partitioned chunk of data using the
specified number of bins and adds this local histogram results to the
global <code class="docutils literal notranslate"><span class="pre">hist</span></code> array using a reduction mechanism.</p>
<p>The task decorator specifies GPU execution via <code class="docutils literal notranslate"><span class="pre">VariantCode.GPU</span></code>. The
<code class="docutils literal notranslate"><span class="pre">broadcast</span></code> constraint on <code class="docutils literal notranslate"><span class="pre">hist</span></code> ensures that each GPU receives the full
<code class="docutils literal notranslate"><span class="pre">hist</span></code> array rather than a partitioned slice. This means each local <code class="docutils literal notranslate"><span class="pre">hist</span></code>
array has the same size as the global <code class="docutils literal notranslate"><span class="pre">hist</span></code> array. This allows every GPU
task to compute a local histogram on its data chunk and safely add its
results to the global <code class="docutils literal notranslate"><span class="pre">hist</span></code> array, ensuring correct accumulation of
counts from all distributed <code class="docutils literal notranslate"><span class="pre">data</span></code> partitions.</p>
<p>In this example, Legate will partition the <code class="docutils literal notranslate"><span class="pre">data</span></code> array automatically and
distribute chunks of it to different GPUs.</p>
<p>For example, imagine we have 4 GPUs, and the input data size is 1000.
Then:</p>
<ul class="simple">
<li><p>GPU 1 might get data [0249]</p></li>
<li><p>GPU 2 might get data [250499]</p></li>
<li><p>GPU 3 might get data [500749]</p></li>
<li><p>GPU 4 might get data [750999]</p></li>
</ul>
<p>Since hist is declared as a <code class="docutils literal notranslate"><span class="pre">ReductionArray[ADD]</span></code>, Legate automatically
merges all the local histograms from all the GPUs by summing them
together at the end of the task execution. This produces the correct
global histogram as the final output.</p>
<p>In short, <code class="docutils literal notranslate"><span class="pre">broadcast</span></code> makes sure that the full <code class="docutils literal notranslate"><span class="pre">hist</span></code> array is available on
all devices, and the reduction mechanism handles merging the partial
results into a correct final output.</p>
</section>
<section id="id3">
<h3>Complete module<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>Putting the pieces above together, here is a complete module that
can be run with the <code class="docutils literal notranslate"><span class="pre">legate</span></code> command line launcher:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cupynumeric</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cpn</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">legate.core</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">lg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">legate.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">broadcast</span><span class="p">,</span> <span class="n">VariantCode</span><span class="p">,</span> <span class="n">TaskContext</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">legate.core.task</span><span class="w"> </span><span class="kn">import</span> <span class="n">task</span><span class="p">,</span> <span class="n">InputArray</span><span class="p">,</span> <span class="n">ReductionArray</span><span class="p">,</span> <span class="n">ADD</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">legate.timing</span><span class="w"> </span><span class="kn">import</span> <span class="n">time</span>


<span class="c1"># [histogram-start]</span>
<span class="nd">@task</span><span class="p">(</span>
    <span class="n">variants</span><span class="o">=</span><span class="p">(</span><span class="n">VariantCode</span><span class="o">.</span><span class="n">CPU</span><span class="p">,</span> <span class="n">VariantCode</span><span class="o">.</span><span class="n">GPU</span><span class="p">),</span>
    <span class="n">constraints</span><span class="o">=</span><span class="p">(</span><span class="n">broadcast</span><span class="p">(</span><span class="s2">&quot;hist&quot;</span><span class="p">),),</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">histogram_task</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">TaskContext</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">InputArray</span><span class="p">,</span> <span class="n">hist</span><span class="p">:</span> <span class="n">ReductionArray</span><span class="p">[</span><span class="n">ADD</span><span class="p">],</span> <span class="n">N_bins</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">cupy</span> <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_variant_kind</span><span class="p">()</span> <span class="o">==</span> <span class="n">VariantCode</span><span class="o">.</span><span class="n">GPU</span> <span class="k">else</span> <span class="n">numpy</span>
    <span class="n">data_local</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">hist_local</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>

    <span class="n">local_hist</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">data_local</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">N_bins</span><span class="p">)</span>
    <span class="n">hist_local</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">hist_local</span> <span class="o">+</span> <span class="n">local_hist</span>


<span class="c1"># [histogram-end]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Run Histogram operation.&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--size&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Size of input arrays&quot;</span>
    <span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="c1"># [input-section]</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">size</span>
    <span class="n">NUM_BINS</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">NUM_BINS</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">size</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cpn</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
    <span class="n">hist</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">NUM_BINS</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cpn</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

    <span class="n">histogram_task</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">hist</span><span class="p">,</span> <span class="n">NUM_BINS</span><span class="p">)</span>
    <span class="c1"># [function-call]</span>

    <span class="c1"># Benchmark run</span>
    <span class="n">rt</span> <span class="o">=</span> <span class="n">lg</span><span class="o">.</span><span class="n">get_legate_runtime</span><span class="p">()</span>
    <span class="n">rt</span><span class="o">.</span><span class="n">issue_execution_fence</span><span class="p">()</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

    <span class="n">histogram_task</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">hist</span><span class="p">,</span> <span class="n">NUM_BINS</span><span class="p">)</span>

    <span class="n">rt</span><span class="o">.</span><span class="n">issue_execution_fence</span><span class="p">()</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Time elapsed for histogram : </span><span class="si">{</span><span class="p">(</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> milliseconds&quot;</span>
    <span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id4">
<h3>Running on CPU and GPU<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>In order to run the program, use the legate launcher, and include any
flags necessary like <code class="docutils literal notranslate"><span class="pre">--cpu</span></code>, <code class="docutils literal notranslate"><span class="pre">--gpu</span></code>, and more. If you want to run
specifically only on CPU, you must add the flag <code class="docutils literal notranslate"><span class="pre">--gpus</span> <span class="pre">0</span></code>.
For a complete guide and additional options, see the <a class="reference external" href="https://docs.nvidia.com/legate/latest/usage.html">Legate documentation</a>.</p>
<p>Lets set the size of the input array to 10 million. Well also include
a warm-up run before measuring execution time to ensure that one-time
setup costs (like memory allocation or kernel loading) dont affect the
final performance results.</p>
<section id="id6">
<h4>CPU execution<a class="headerlink" href="#id6" title="Link to this heading">#</a></h4>
<p>To run with CPU, use the following command.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>legate<span class="w"> </span>--cpus<span class="w"> </span><span class="m">1</span><span class="w"> </span>--gpus<span class="w"> </span><span class="m">0</span><span class="w"> </span>./histogram.py<span class="w"> </span>--size<span class="w"> </span><span class="m">10000000</span>
</pre></div>
</div>
<p>This produces the following output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Time elapsed for histogram: 123.041000 milliseconds
</pre></div>
</div>
</section>
<section id="id7">
<h4>GPU execution<a class="headerlink" href="#id7" title="Link to this heading">#</a></h4>
<p>To run with GPU, use the following command.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>legate<span class="w"> </span>--gpus<span class="w"> </span><span class="m">2</span><span class="w"> </span>./histogram.py<span class="w"> </span>--size<span class="w"> </span><span class="m">10000000</span>
</pre></div>
</div>
<p>This produces the following output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Time elapsed for histogram : 3.790000 milliseconds
</pre></div>
</div>
</section>
<section id="id8">
<h4>Multi-Node execution<a class="headerlink" href="#id8" title="Link to this heading">#</a></h4>
<p>Refer to the Legate documentation on how to run on <a class="reference external" href="https://docs.nvidia.com/legate/latest/usage.html">multi-node</a>.
Here is an example performed on the <a class="reference external" href="https://docs.nersc.gov/systems/perlmutter/architecture/">Perlmutter</a> supercomputer.</p>
<p>To run with Multi-Node, use the following command.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>legate<span class="w"> </span>--nodes<span class="w"> </span><span class="m">2</span><span class="w"> </span>--launcher<span class="w"> </span>srun<span class="w"> </span>--gpus<span class="w"> </span><span class="m">4</span><span class="w"> </span>--ranks-per-node<span class="w"> </span><span class="m">1</span><span class="w"> </span>./histogram.py<span class="w"> </span>--size<span class="w"> </span><span class="m">10000000</span>
</pre></div>
</div>
<p>This produces the following output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Time elapsed for histogram : 3.716000 milliseconds
</pre></div>
</div>
</section>
</section>
</section>
<section id="simple-matrix-multiplication-problem">
<h2>Simple matrix multiplication problem<a class="headerlink" href="#simple-matrix-multiplication-problem" title="Link to this heading">#</a></h2>
<p>We multiply two matrices <code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">(shape</span> <span class="pre">(m,</span> <span class="pre">k))</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span> <span class="pre">(shape</span> <span class="pre">(k,</span> <span class="pre">n))</span></code> to
produce <code class="docutils literal notranslate"><span class="pre">C</span> <span class="pre">(shape</span> <span class="pre">(m,</span> <span class="pre">n))</span></code>, using 3D tiling to enable parallel execution
over blocks of the matrix. This example will introduce basic matrix
multiplication using Legate and cuPyNumeric. It emphasizes 3D tiling and
reduction privileges, teaching how to structure tasks for parallel
execution by promoting arrays for consistent partitioning and aligning
the inputs and outputs, and then safely reducing partial results.</p>
<section id="id11">
<h3>Main function<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<p>The following main function prepares input matrices with proper broadcasting, executes the matrix multiplication task, and measures the computation time.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">n</span>

    <span class="n">A_cpn</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
    <span class="n">B_cpn</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="n">C_cpn</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

    <span class="c1"># Broadcasting to match Legate alignment requirements</span>
    <span class="n">A_cpn</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span>
        <span class="n">A_cpn</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">cpn</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="p">)</span>  <span class="c1"># (m,k,1)  (m,k,n)</span>
    <span class="n">B_cpn</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">B_cpn</span><span class="p">[</span><span class="n">cpn</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="n">C_cpn</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">C_cpn</span><span class="p">[:,</span> <span class="n">cpn</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:],</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

    <span class="n">matmul_task</span><span class="p">(</span><span class="n">C_cpn</span><span class="p">,</span> <span class="n">A_cpn</span><span class="p">,</span> <span class="n">B_cpn</span><span class="p">)</span>
</pre></div>
</div>
<p>The important things that this code does are:</p>
<ul class="simple">
<li><p>Defines the dimensions of the matrices using the values of m, k, and
n, which are obtained from command-line arguments.</p></li>
<li><p>Initializes input matrices A and B with random integers and output
matrix C with zeros.</p></li>
<li><p>Ensures that the inner dimensions of A and B match, which is required
for valid matrix multiplication.</p></li>
<li><p>Each matrix is promoted to 3D by adding an extra dimension. Because,
in order to correctly partition the computation, matrices <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code>, and <code class="docutils literal notranslate"><span class="pre">C</span></code>
should be partitioned in an aligned way. Given the dimension of these
matrices are <code class="docutils literal notranslate"><span class="pre">A[m,k]</span></code>, <code class="docutils literal notranslate"><span class="pre">B[k,n]</span></code>, and <code class="docutils literal notranslate"><span class="pre">C[m,n]</span></code>, they cannot be aligned
directly. By adding one dimension to each of them, the dimensions
become <code class="docutils literal notranslate"><span class="pre">A[m,</span> <span class="pre">k,</span> <span class="pre">n]</span></code>, <code class="docutils literal notranslate"><span class="pre">B[m,</span> <span class="pre">k,</span> <span class="pre">n]</span></code> and <code class="docutils literal notranslate"><span class="pre">C[m,</span> <span class="pre">k,</span> <span class="pre">n]</span></code>. The three arrays can now
be aligned along <code class="docutils literal notranslate"><span class="pre">m</span></code>, <code class="docutils literal notranslate"><span class="pre">k</span></code>, and <code class="docutils literal notranslate"><span class="pre">n</span></code> dimensions, producing the required
alignment for performing matrix multiplication.</p></li>
</ul>
</section>
<section id="id12">
<h3>Task function<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<p>The following example shows a task function that performs matrix multiplication with aligned partitions across input and output arrays.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@task</span><span class="p">(</span>
    <span class="n">variants</span><span class="o">=</span><span class="p">(</span><span class="n">VariantCode</span><span class="o">.</span><span class="n">CPU</span><span class="p">,</span> <span class="n">VariantCode</span><span class="o">.</span><span class="n">GPU</span><span class="p">),</span>
    <span class="n">constraints</span><span class="o">=</span><span class="p">(</span><span class="n">align</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">),</span> <span class="n">align</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">)),</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">matmul_task</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">TaskContext</span><span class="p">,</span> <span class="n">C</span><span class="p">:</span> <span class="n">ReductionArray</span><span class="p">[</span><span class="n">ADD</span><span class="p">],</span> <span class="n">A</span><span class="p">:</span> <span class="n">InputArray</span><span class="p">,</span> <span class="n">B</span><span class="p">:</span> <span class="n">InputArray</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">cupy</span> <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_variant_kind</span><span class="p">()</span> <span class="o">==</span> <span class="n">VariantCode</span><span class="o">.</span><span class="n">GPU</span> <span class="k">else</span> <span class="n">numpy</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">C</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">A</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">B</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
    <span class="n">C</span> <span class="o">+=</span> <span class="n">xp</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>


</pre></div>
</div>
<p>The task can run on either CPU or GPU, depending on the available resources at runtime.
The alignment constraints <code class="docutils literal notranslate"><span class="pre">align(C,</span> <span class="pre">A)</span></code> and <code class="docutils literal notranslate"><span class="pre">align(C,</span> <span class="pre">B)</span></code> ensures that partitions of <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code>, and
<code class="docutils literal notranslate"><span class="pre">C</span></code> so that each task instance gets matching chunks of data. If <code class="docutils literal notranslate"><span class="pre">align</span></code> is
not used, partitions could be mismatched, leading to errors or even
incorrect results. For example, if GPU 0 is given block (0:25, 0:38)
of <code class="docutils literal notranslate"><span class="pre">A</span></code> and block (0:38, 0:50) of <code class="docutils literal notranslate"><span class="pre">B</span></code>, then it should be given the correct
block (0:25, 0:50) of <code class="docutils literal notranslate"><span class="pre">C</span></code> to update. For example, after promotion to <code class="docutils literal notranslate"><span class="pre">A(m,k,n)</span></code>, <code class="docutils literal notranslate"><span class="pre">B(m,k,n)</span></code>, <code class="docutils literal notranslate"><span class="pre">C(m,k,n)</span></code>, the
<code class="docutils literal notranslate"><span class="pre">align</span></code> constraint could produce the partitioning <code class="docutils literal notranslate"><span class="pre">A(0:m/2,</span> <span class="pre">0:k/2,</span>
<span class="pre">0:n/2)</span></code>, <code class="docutils literal notranslate"><span class="pre">B(0:m/2,</span> <span class="pre">0:k/2,</span> <span class="pre">0:n/2)</span></code>, <code class="docutils literal notranslate"><span class="pre">C(0:m/2,</span> <span class="pre">0:k/2,</span> <span class="pre">0:n/2)</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">matmul_task</span></code> function uses <code class="docutils literal notranslate"><span class="pre">TaskContext</span></code> to determine if its running
on a CPU or GPU, setting <code class="docutils literal notranslate"><span class="pre">xp</span></code> to NumPy or CuPy accordingly. It then
converts the received task-local data to array views using <code class="docutils literal notranslate"><span class="pre">xp.asarray()</span></code>.
The extra broadcasted dimension introduced earlier is then sliced away
to recover the original 2D shapes of the matrices. Finally performs the
matrix multiplication and accumulates the result into <code class="docutils literal notranslate"><span class="pre">C</span></code>.</p>
</section>
<section id="id13">
<h3>Complete module<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<p>Putting the pieces above together, here is a complete module that
can be run with the <code class="docutils literal notranslate"><span class="pre">legate</span></code> command line launcher:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cupynumeric</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cpn</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">legate.core</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">lg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">legate.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">VariantCode</span><span class="p">,</span> <span class="n">align</span><span class="p">,</span> <span class="n">TaskContext</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">legate.core.task</span><span class="w"> </span><span class="kn">import</span> <span class="n">task</span><span class="p">,</span> <span class="n">InputArray</span><span class="p">,</span> <span class="n">ReductionArray</span><span class="p">,</span> <span class="n">ADD</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">legate.timing</span><span class="w"> </span><span class="kn">import</span> <span class="n">time</span>


<span class="c1"># [matmul-start]</span>
<span class="nd">@task</span><span class="p">(</span>
    <span class="n">variants</span><span class="o">=</span><span class="p">(</span><span class="n">VariantCode</span><span class="o">.</span><span class="n">CPU</span><span class="p">,</span> <span class="n">VariantCode</span><span class="o">.</span><span class="n">GPU</span><span class="p">),</span>
    <span class="n">constraints</span><span class="o">=</span><span class="p">(</span><span class="n">align</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">),</span> <span class="n">align</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">)),</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">matmul_task</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">TaskContext</span><span class="p">,</span> <span class="n">C</span><span class="p">:</span> <span class="n">ReductionArray</span><span class="p">[</span><span class="n">ADD</span><span class="p">],</span> <span class="n">A</span><span class="p">:</span> <span class="n">InputArray</span><span class="p">,</span> <span class="n">B</span><span class="p">:</span> <span class="n">InputArray</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">cupy</span> <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_variant_kind</span><span class="p">()</span> <span class="o">==</span> <span class="n">VariantCode</span><span class="o">.</span><span class="n">GPU</span> <span class="k">else</span> <span class="n">numpy</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">C</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">A</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">B</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
    <span class="n">C</span> <span class="o">+=</span> <span class="n">xp</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>


<span class="c1"># [matmul-end]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Run Matrix multiplication operation&quot;</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Number of rows in matrix A and C&quot;</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-k&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Number of columns in A / rows in B&quot;</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-n&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Number of columns in matrix B and C&quot;</span>
    <span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="c1"># [input-section]</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">n</span>

    <span class="n">A_cpn</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
    <span class="n">B_cpn</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="n">C_cpn</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

    <span class="c1"># Broadcasting to match Legate alignment requirements</span>
    <span class="n">A_cpn</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span>
        <span class="n">A_cpn</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">cpn</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="p">)</span>  <span class="c1"># (m,k,1)  (m,k,n)</span>
    <span class="n">B_cpn</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">B_cpn</span><span class="p">[</span><span class="n">cpn</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="n">C_cpn</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">C_cpn</span><span class="p">[:,</span> <span class="n">cpn</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:],</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

    <span class="n">matmul_task</span><span class="p">(</span><span class="n">C_cpn</span><span class="p">,</span> <span class="n">A_cpn</span><span class="p">,</span> <span class="n">B_cpn</span><span class="p">)</span>
    <span class="c1"># [function-call]</span>

    <span class="c1"># Benchmark run</span>
    <span class="n">rt</span> <span class="o">=</span> <span class="n">lg</span><span class="o">.</span><span class="n">get_legate_runtime</span><span class="p">()</span>
    <span class="n">rt</span><span class="o">.</span><span class="n">issue_execution_fence</span><span class="p">()</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

    <span class="n">matmul_task</span><span class="p">(</span><span class="n">C_cpn</span><span class="p">,</span> <span class="n">A_cpn</span><span class="p">,</span> <span class="n">B_cpn</span><span class="p">)</span>

    <span class="n">rt</span><span class="o">.</span><span class="n">issue_execution_fence</span><span class="p">()</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Time elapsed for matmul: </span><span class="si">{</span><span class="p">(</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id14">
<h3>Running on CPU and GPU<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<p>In order to run the program, use the legate launcher, and include any
flags necessary like <code class="docutils literal notranslate"><span class="pre">--cpu</span></code>, <code class="docutils literal notranslate"><span class="pre">--gpu</span></code>, and more. If you want to run
specifically only on CPU, you must add the flag <code class="docutils literal notranslate"><span class="pre">--gpus</span> <span class="pre">0</span></code>.
For a complete guide and additional options, see the <a class="reference external" href="https://docs.nvidia.com/legate/latest/usage.html">Legate documentation</a>.</p>
<p>Lets increase the size of the matrix by setting <code class="docutils literal notranslate"><span class="pre">m</span></code> = 1000, <code class="docutils literal notranslate"><span class="pre">k</span></code> = 1000, and
<code class="docutils literal notranslate"><span class="pre">n</span></code> = 1000. Well also include a warm-up run before measuring execution
time to ensure that one-time setup costs (like memory allocation or
kernel loading) dont affect the final performance results.</p>
<section id="id16">
<h4>CPU execution<a class="headerlink" href="#id16" title="Link to this heading">#</a></h4>
<p>To run with CPU, use the following command.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>legate<span class="w"> </span>--cpus<span class="w"> </span><span class="m">1</span><span class="w"> </span>--gpus<span class="w"> </span><span class="m">0</span><span class="w"> </span>./matmul.py<span class="w"> </span>-m<span class="w"> </span><span class="m">1000</span><span class="w"> </span>-k<span class="w"> </span><span class="m">1000</span><span class="w"> </span>-n<span class="w"> </span><span class="m">1000</span>
</pre></div>
</div>
<p>This produces the following output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Time elapsed for matmul: 902.748000 milliseconds
</pre></div>
</div>
</section>
<section id="id17">
<h4>GPU execution<a class="headerlink" href="#id17" title="Link to this heading">#</a></h4>
<p>To run with GPU, use the following command.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>legate<span class="w"> </span>--gpus<span class="w"> </span><span class="m">2</span><span class="w"> </span>./matmul.py<span class="w"> </span>-m<span class="w"> </span><span class="m">1000</span><span class="w"> </span>-k<span class="w"> </span><span class="m">1000</span><span class="w"> </span>-n<span class="w"> </span><span class="m">1000</span>
</pre></div>
</div>
<p>This produces the following output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Time elapsed for matmul: 2.776000 milliseconds
</pre></div>
</div>
</section>
<section id="id18">
<h4>Multi-Node execution<a class="headerlink" href="#id18" title="Link to this heading">#</a></h4>
<p>Refer to the Legate documentation on how to run on <a class="reference external" href="https://docs.nvidia.com/legate/latest/usage.html">multi-node</a>.
Here is an example performed on the <a class="reference external" href="https://docs.nersc.gov/systems/perlmutter/architecture/">Perlmutter</a> supercomputer.</p>
<p>To run with Multi-Node, use the following command.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>legate<span class="w"> </span>--nodes<span class="w"> </span><span class="m">2</span><span class="w"> </span>--launcher<span class="w"> </span>srun<span class="w"> </span>--gpus<span class="w"> </span><span class="m">4</span><span class="w"> </span>--ranks-per-node<span class="w"> </span><span class="m">1</span><span class="w"> </span>./matmul.py<span class="w"> </span>-m<span class="w"> </span><span class="m">1000</span><span class="w"> </span>-k<span class="w"> </span><span class="m">1000</span><span class="w"> </span>-n<span class="w"> </span><span class="m">1000</span>
</pre></div>
</div>
<p>This produces the following output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Time elapsed for matmul: 2.926000 milliseconds
</pre></div>
</div>
</section>
</section>
</section>
<section id="fast-fourier-transform-problem">
<h2>Fast Fourier Transform problem<a class="headerlink" href="#fast-fourier-transform-problem" title="Link to this heading">#</a></h2>
<p>The Fast Fourier Transform (FFT) is an algorithm which is used to
compute the discrete fourier transform of a sequence. It is used to help
break down a complex signal like sound and images, which is instrumental
in image processing, medical imaging, and more. This example
demonstrates how to use Legate and cuPyNumeric to perform a batched 2D Fast
Fourier Transform. It highlights how to use <code class="docutils literal notranslate"><span class="pre">align</span></code> and <code class="docutils literal notranslate"><span class="pre">broadcast</span></code>
constraints to control partitioning. Alignment makes sure the input and
output chunks line up correctly while broadcasting keeps part of data
unpartitioned.</p>
<section id="id21">
<h3>Main function<a class="headerlink" href="#id21" title="Link to this heading">#</a></h3>
<p>The following code block initializes inputs and performs a GPU-accelerated batched 2D Fast Fourier Transform.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)))</span>

    <span class="n">A_cpn</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cpn</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
    <span class="n">B_cpn</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">cpn</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>

    <span class="n">fft2d_batched_gpu</span><span class="p">(</span><span class="n">A_cpn</span><span class="p">,</span> <span class="n">B_cpn</span><span class="p">)</span>
</pre></div>
</div>
<p>For demonstration purposes, a default shape of (128, 256, 256) is used,
representing a batch of 128 two dimensional matrices. Using this shape,
cuPyNumeric arrays are generated, and cast to complex64. <code class="docutils literal notranslate"><span class="pre">B_cpn</span></code> contains
random values, while <code class="docutils literal notranslate"><span class="pre">A_cpn</span></code> contains zeros. The <code class="docutils literal notranslate"><span class="pre">fft2d_batched_gpu</span></code> task is
then launched, by using these two cuPyNumeric arrays. We can change the
shape of the input arrays using the <code class="docutils literal notranslate"><span class="pre">--shape</span></code> command-line argument when
running the script</p>
</section>
<section id="id22">
<h3>Task function<a class="headerlink" href="#id22" title="Link to this heading">#</a></h3>
<p>The following example defines a task that computes a batched 2D FFT over input data using <code class="docutils literal notranslate"><span class="pre">align</span></code> and <code class="docutils literal notranslate"><span class="pre">broadcast</span></code> constraints.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@task</span><span class="p">(</span>
    <span class="n">variants</span><span class="o">=</span><span class="p">(</span><span class="n">VariantCode</span><span class="o">.</span><span class="n">CPU</span><span class="p">,</span> <span class="n">VariantCode</span><span class="o">.</span><span class="n">GPU</span><span class="p">),</span>
    <span class="n">constraints</span><span class="o">=</span><span class="p">(</span><span class="n">align</span><span class="p">(</span><span class="s2">&quot;dst&quot;</span><span class="p">,</span> <span class="s2">&quot;src&quot;</span><span class="p">),</span> <span class="n">broadcast</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))),</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fft2d_batched_gpu</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">TaskContext</span><span class="p">,</span> <span class="n">dst</span><span class="p">:</span> <span class="n">OutputStore</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="n">InputStore</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">cupy</span> <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_variant_kind</span><span class="p">()</span> <span class="o">==</span> <span class="n">VariantCode</span><span class="o">.</span><span class="n">GPU</span> <span class="k">else</span> <span class="n">numpy</span>
    <span class="n">cp_src</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
    <span class="n">cp_dst</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>
    <span class="n">cp_dst</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftn</span><span class="p">(</span>
        <span class="n">cp_src</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="p">)</span>  <span class="c1"># Apply 2D FFT across axes 1 and 2</span>


</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">fft2d_batched_gpu</span></code> function uses <code class="docutils literal notranslate"><span class="pre">TaskContext</span></code> to detect execution on
GPU and sets <code class="docutils literal notranslate"><span class="pre">xp</span></code> to CuPy accordingly. It then converts the <code class="docutils literal notranslate"><span class="pre">src</span></code> and <code class="docutils literal notranslate"><span class="pre">dst</span></code>
arrays into CuPy arrays as views without copying. Afterwards, it applies
2D FFT for each batch independently. As for the task decorator, it has a
<code class="docutils literal notranslate"><span class="pre">VariantCode.GPU</span></code>, which means this task is implemented for GPU execution.
As for the <code class="docutils literal notranslate"><span class="pre">align</span></code> constraint, it ensures that the output and input arrays
are partitioned the same way. This ensures that the corresponding chunks
are processed together. The other constraint <code class="docutils literal notranslate"><span class="pre">broadcast</span></code> makes sure the
source array is not partitioned along axes 1 and 2. This is important as
it allows each GPU to get full slices along these axes, and makes sure
that you are able to split work along the batch dimension (axis 0).</p>
<p>For example, lets imagine the shape of <code class="docutils literal notranslate"><span class="pre">src</span></code> is (128, 256, 256). This
means there are 128 independent 2D images, each of size 256256. If
<code class="docutils literal notranslate"><span class="pre">broadcast</span></code> is not used, then it might get partitioned like this.</p>
<ul class="simple">
<li><p>GPU 0: slices src[0:64, 0:128, :]</p></li>
<li><p>GPU 1: slices src[64:128, 128:256, :]</p></li>
</ul>
<p>Now each GPU has partial rows from multiple images, which may lead to
incorrect FFT computations.</p>
<p>But with <code class="docutils literal notranslate"><span class="pre">broadcast(&quot;src&quot;,</span> <span class="pre">(1,</span> <span class="pre">2))</span></code>, this ensures Legate will partition
only along axis 0, so each GPU gets a full 2D matrix per batch.</p>
<ul class="simple">
<li><p>GPU 0: src[0:64, :, :]  64 full images</p></li>
<li><p>GPU 1: src[64:128, :, :]  remaining 64 full images</p></li>
</ul>
</section>
<section id="id23">
<h3>Complete module<a class="headerlink" href="#id23" title="Link to this heading">#</a></h3>
<p>Putting the pieces above together, here is a complete module that
can be run with the <code class="docutils literal notranslate"><span class="pre">legate</span></code> command line launcher:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cupynumeric</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cpn</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">legate.core</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">lg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">legate.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">align</span><span class="p">,</span> <span class="n">broadcast</span><span class="p">,</span> <span class="n">VariantCode</span><span class="p">,</span> <span class="n">TaskContext</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">legate.core.task</span><span class="w"> </span><span class="kn">import</span> <span class="n">InputStore</span><span class="p">,</span> <span class="n">OutputStore</span><span class="p">,</span> <span class="n">task</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">legate.timing</span><span class="w"> </span><span class="kn">import</span> <span class="n">time</span>


<span class="c1"># [fft-start]</span>
<span class="nd">@task</span><span class="p">(</span>
    <span class="n">variants</span><span class="o">=</span><span class="p">(</span><span class="n">VariantCode</span><span class="o">.</span><span class="n">CPU</span><span class="p">,</span> <span class="n">VariantCode</span><span class="o">.</span><span class="n">GPU</span><span class="p">),</span>
    <span class="n">constraints</span><span class="o">=</span><span class="p">(</span><span class="n">align</span><span class="p">(</span><span class="s2">&quot;dst&quot;</span><span class="p">,</span> <span class="s2">&quot;src&quot;</span><span class="p">),</span> <span class="n">broadcast</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))),</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fft2d_batched_gpu</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">TaskContext</span><span class="p">,</span> <span class="n">dst</span><span class="p">:</span> <span class="n">OutputStore</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="n">InputStore</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">cupy</span> <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_variant_kind</span><span class="p">()</span> <span class="o">==</span> <span class="n">VariantCode</span><span class="o">.</span><span class="n">GPU</span> <span class="k">else</span> <span class="n">numpy</span>
    <span class="n">cp_src</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
    <span class="n">cp_dst</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>
    <span class="n">cp_dst</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftn</span><span class="p">(</span>
        <span class="n">cp_src</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="p">)</span>  <span class="c1"># Apply 2D FFT across axes 1 and 2</span>


<span class="c1"># [fft-end]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Run FFT operation&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--shape&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;128,256,256&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Shape of the array in the format D1,D2,D3&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="c1"># [input-section]</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)))</span>

    <span class="n">A_cpn</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cpn</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
    <span class="n">B_cpn</span> <span class="o">=</span> <span class="n">cpn</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">cpn</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>

    <span class="n">fft2d_batched_gpu</span><span class="p">(</span><span class="n">A_cpn</span><span class="p">,</span> <span class="n">B_cpn</span><span class="p">)</span>
    <span class="c1"># [function-call]</span>

    <span class="c1"># benchmark run</span>
    <span class="n">rt</span> <span class="o">=</span> <span class="n">lg</span><span class="o">.</span><span class="n">get_legate_runtime</span><span class="p">()</span>
    <span class="n">rt</span><span class="o">.</span><span class="n">issue_execution_fence</span><span class="p">()</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

    <span class="n">fft2d_batched_gpu</span><span class="p">(</span><span class="n">A_cpn</span><span class="p">,</span> <span class="n">B_cpn</span><span class="p">)</span>

    <span class="n">rt</span><span class="o">.</span><span class="n">issue_execution_fence</span><span class="p">()</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Time elapsed for batched fft: </span><span class="si">{</span><span class="p">(</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> milliseconds&quot;</span>
    <span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id24">
<h3>Running on CPU and GPU<a class="headerlink" href="#id24" title="Link to this heading">#</a></h3>
<p>In order to run the program, use the legate launcher, and include any
flags necessary like <code class="docutils literal notranslate"><span class="pre">--cpu</span></code>, <code class="docutils literal notranslate"><span class="pre">--gpu</span></code>, and more. If you want to run
specifically only on CPU, you must add the flag <code class="docutils literal notranslate"><span class="pre">--gpus</span> <span class="pre">0</span></code>.
For a complete guide and additional options, see the <a class="reference external" href="https://docs.nvidia.com/legate/latest/usage.html">Legate documentation</a>.</p>
<section id="id26">
<h4>CPU execution<a class="headerlink" href="#id26" title="Link to this heading">#</a></h4>
<p>To run with CPU, use the following command.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>legate<span class="w"> </span>--cpus<span class="w"> </span><span class="m">1</span><span class="w"> </span>--gpus<span class="w"> </span><span class="m">0</span><span class="w"> </span>./fft.py
</pre></div>
</div>
<p>This produces the following output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Time elapsed for fft: 173.655000 milliseconds
</pre></div>
</div>
</section>
<section id="id27">
<h4>GPU execution<a class="headerlink" href="#id27" title="Link to this heading">#</a></h4>
<p>To run with GPU, use the following command.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>legate<span class="w"> </span>--gpus<span class="w"> </span><span class="m">2</span><span class="w"> </span>./fft.py
</pre></div>
</div>
<p>This produces the following output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Time elapsed for fft: 0.573000 milliseconds
</pre></div>
</div>
</section>
<section id="id28">
<h4>Multi-Node execution<a class="headerlink" href="#id28" title="Link to this heading">#</a></h4>
<p>Refer to the Legate documentation on how to run on <a class="reference external" href="https://docs.nvidia.com/legate/latest/usage.html">multi-node</a>.
Here is an example performed on the <a class="reference external" href="https://docs.nersc.gov/systems/perlmutter/architecture/">Perlmutter</a> supercomputer.</p>
<p>To run with Multi-Node, use the following command.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>legate<span class="w"> </span>--nodes<span class="w"> </span><span class="m">2</span><span class="w"> </span>--launcher<span class="w"> </span>srun<span class="w"> </span>--gpus<span class="w"> </span><span class="m">4</span><span class="w"> </span>--ranks-per-node<span class="w"> </span><span class="m">1</span><span class="w"> </span>./fft.py
</pre></div>
</div>
<p>This produces the following output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Time elapsed for fft: 0.613000 milliseconds
</pre></div>
</div>
</section>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tutorial</p>
      </div>
    </a>
    <a class="right-next"
       href="../examples/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Examples</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            


              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-legate-task">What is a Legate task?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-example">Quick example</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-this-example">Understanding this example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#saxpy-problem">SAXPY problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-function">Main function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-function">Task function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#complete-module">Complete module</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#running-on-cpu-and-gpu">Running on CPU and GPU</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cpu-execution">CPU execution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#gpu-execution">GPU execution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-node-execution">Multi-Node execution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#histogram-problem">Histogram problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-function-1">Main function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Task function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Complete module</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Running on CPU and GPU</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">CPU execution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">GPU execution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Multi-Node execution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-matrix-multiplication-problem">Simple matrix multiplication problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Main function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Task function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Complete module</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Running on CPU and GPU</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">CPU execution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">GPU execution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Multi-Node execution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fast-fourier-transform-problem">Fast Fourier Transform problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">Main function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">Task function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">Complete module</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">Running on CPU and GPU</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">CPU execution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">GPU execution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">Multi-Node execution</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            

          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  

  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>


  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
<a class="footer-brand logo" href="https://www.nvidia.com">
  <img src="../_static/nvidia-logo-horiz-rgb-1c-blk-for-screen.svg" class="logo__image only-light" alt="NVIDIA"/>
  <img src="../_static/nvidia-logo-horiz-rgb-1c-wht-for-screen.svg" class="logo__image only-dark" alt="NVIDIA"/>
</a></div>
      
        <div class="footer-item">

<div class="footer-links">
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/privacy-policy/">Privacy Policy</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/privacy-center/">Your Privacy Choices</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/terms-of-service/">Terms of Service</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/accessibility/">Accessibility</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/company-policies/">Corporate Policies</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/product-security/">Product Security</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/contact/">Contact</a>
  
  
  
</div>
</div>
      
        <div class="footer-item">




  <p class="copyright">
    
      Copyright  2024, NVIDIA.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
<div class="extra_footer">
  
  The cuPyNumeric project is independent of the CuPy project. CuPy is a trademark of Preferred Networks, Inc, and the name 'cuPyNumeric' is used with their permission.
  
  <script type="text/javascript">if (typeof _satellite !== undefined){ _satellite.pageBottom();}</script>
  
</div></div>
      
    </div>
  
  
  
</div>

  </footer>
  </body>
</html>